# VK BOT 
Проект бота для сайта [vk.com](https://vk.com)

Проект написан при помощи библиотеки [vk_api](https://pypi.org/project/vk-api/).

В проекте использовалась ORM [peewee](http://docs.peewee-orm.com/en/latest/)

База данных [PostgreSQL](https://www.postgresql.org/)

---
## Запуск и установка

Чтобы запустить проект клонируйте репозиторий.

Создайте в проекте файл `settings.py`.

Затем из файла `settings.py.default` скопируйте все настройки
в файл `settings.py`.

В файле `settings.py` укажите свой токен и группу

```
TOKEN = YOU_TOKEN
GROUP_ID = YOU_GROUP_ID
```

В этом же файле укажите конфигурацию вашей базы данных.

```
DB_CONFIG = dict(
    database='name_data_base',
    user='postgres',
    password='you_password',
    host='',
    port=5432
)
```
После того как укажете конфигурацию запустите файл `data_base.py`.
Таблицы базы данных будут созданы автоматически.

Для запуска бота запустите файл `bot.py`.

Бот работает по заранее написаному сценарию который расписан в файле
`settings.py.default`.

---
## Описание работы бота

После запуска фалй `bot.py`. напишите любое сообщение вашему боту.

В ответ вы получите следующее сообщение:

*Я бот, созданный для того, чтобы найти авиабилеты.
Введите /ticket для заказа билетов или /help для справки.*

Команада `/help` выведет на экран следующее сообщение:

*Введите /ticket чтобы начать поиск авиабилетов.
Пишите города русскими буквами.
Если вы хотите начать поиск билетов заново введите /ticket.
Для вызова данного сообщения повторно введите /help.*

Команда `/ticket` запускает сценарий.

После запуска сценария бот будет спрашивать
необходимую информацию и заносить ее в БД.

### ! Учебный проект!

В данном проекте билеты генерирует написаный диспетчер.

Города между которыми диспетчер генерирует рейсы прописаны в файле `settings.py`

`CITY_LIST = ['Москва', 'Питер', 'Лондон', 'Париж']`

Диспетчер генерирует случайны рейсы и записывает их в **JSON** файл.

В настоящих условиях необходимо подключить API сайтов поиска билетов.

Например: 
   - [skyscanner](https://www.skyscanner.ru/)
   - [aviasales](https://www.aviasales.ru/)


После успешного прохождения сценария бот сгенирирует билет на самолет.
На билете будут написаны данные которые вы вводили.

**Данная функция добавлена исключительно в учебных целях**

Пример билета:

![ticket](https://sun9-30.userapi.com/impg/9APcCPAd6DwvX9zSvVsrttNFYxyzhsA6VEvkVw/goAG0q5y42c.jpg?size=672x401&quality=96&proxy=1&sign=160d6508724ef3c09176523f186c73fe&type=album)

Билет генерируется при помощи библиотеки `pillow`

---
## Структура проекта

Папка vk_avia_bot. Основная папка проекта.
   
   - Папка data_base.

      - Файл `data_base.py`. Настройка базы данных.
    
   - Папка dispatcher.

      - Файл `dispatcher.py`. Генерирует авиа-рейсы. Записывает их в **JSON**
    
   - Папка drawing.

      - Папка `fonts`. В ней хранятся шрифты.
    
      - Папка `images`. В ней находится шаблон билета.
    
      - Файл `draw_ticket.py`. Файл генерирует билет.
      
   - Папка tests. Тестирует программу Unit тестами.

      - Файл `test_bot.py` Тест файла `bot.py`
    
      - Файл `test_dispatcher.py`. Тестирует диспетчер
    
   - Файл `bot.py`. Файл с логикой бота. Запуск бота.

   - Файл `handlers.py`. Хранит хэндлеры проекта.

   - Файл `settings.py.default`. Настройки бота.
